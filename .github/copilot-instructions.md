# tech-ox Hugo Blog - AI Agent Instructions

## Architecture Overview

This is a **multilingual Hugo blog** using the Stack theme (git submodule at [themes/stack/](themes/stack/)). Primary language is Chinese (`zh-cn`) with support for Japanese, Arabic, and others via Hugo's i18n system.

- **Theme**: Stack theme (submodule) - card-style blog design
- **Base URL**: https://tech-ox.github.io/ (deployed via GitHub Actions)
- **Main config**: [hugo.yaml](hugo.yaml) - single source of truth for site configuration
- **Content root**: [content/](content/) - organized by post/page/categories
- **Build output**: [public/](public/) - generated by Hugo, excluded from git

## Content Structure & Conventions

### Front Matter Format
Posts use **TOML front matter** (+++...+++) with required fields:
```markdown
+++
date = '2026-01-03T15:29:50+08:00'
draft = true
title = 'MyFirstBlog'
+++
```

### Content Organization
- **Posts**: [content/post/](content/post/) - each post in its own directory with `index.md` or language variants (`index.zh-cn.md`, `index.ja.md`)
- **Pages**: [content/page/](content/page/) - about, archives, links, search
- **Categories**: [content/categories/](content/categories/) - category taxonomies
- **New posts**: Created via `hugo new content/post/<post-name>/index.md` (uses [archetypes/default.md](archetypes/default.md) template)

Example: [content/post/chinese-test/index.zh-cn.md](content/post/chinese-test/index.zh-cn.md) shows typical post structure with images, quotes, and Chinese content.

## Multilingual Setup

- **Default language**: `zh-cn` (configured in [hugo.yaml](hugo.yaml) line 8)
- **hasCJKLanguage**: Set to `true` for proper Chinese/Japanese/Korean word count
- **Language variants**: Use suffixed filenames (e.g., `index.zh-cn.md`, `index.ja.md`)
- **Translation keys**: Stored in [i18n/](i18n/) directory (theme-provided)

## Development Workflow

### Local Development
```bash
hugo server -D  # Run dev server with drafts enabled
hugo -D         # Build with drafts
hugo            # Production build (no drafts)
```

### Creating New Content
```bash
hugo new content/post/<post-name>/index.md
# Edit the generated file in content/post/<post-name>/
# Place images in same directory, reference as ![](image.jpg)
```

### Theme Customization
- **Do NOT edit** [themes/stack/](themes/stack/) directly (git submodule)
- **Override theme files** by copying to [layouts/](layouts/) (currently empty)
- **Custom assets**: Place in [assets/](assets/) directory
- **Static files**: Place in [static/](static/) (avatars, favicons, etc.)

## Deployment Pipeline

**GitHub Actions** ([.github/workflows/hugo_deploy.yaml](.github/workflows/hugo_deploy.yaml)):
- Triggers on push to `main` branch
- Uses Hugo v0.119.0 extended
- Builds site with `hugo -D`
- Deploys to external repository: `chengang9904/chengang9904.github.io`
- Requires `secrets.token` for deployment authentication

## Configuration Highlights

From [hugo.yaml](hugo.yaml):
- **Pagination**: 3 posts per page
- **Permalinks**: `/p/:slug/` for posts
- **Main sections**: Only `post` (line 40)
- **Sidebar avatar**: Enabled, stored at `img/avatar.png` (line 58)
- **Math typesetting**: Disabled by default (line 64)
- **Comments**: Disabled (line 71)
- **Syntax highlighting**: Enabled with line numbers (line 236-243)
- **Unsafe HTML in markdown**: Enabled (line 222)

## Common Patterns

1. **Images in posts**: Place in post directory, reference relatively: `![alt text](image.jpg)`
2. **Draft posts**: Set `draft = true` in front matter; include with `-D` flag
3. **Menu customization**: Add `menu` field to front matter (see [content/_index.zh-cn.md](content/_index.zh-cn.md))
4. **Widgets**: Configured in [hugo.yaml](hugo.yaml) lines 157-172 (search, archives, categories, tag-cloud)

## Important Notes

- **Never commit** [public/](public/) directory (see [.gitignore](.gitignore))
- **Theme updates**: Use `git submodule update --remote themes/stack`
- **Configuration**: All site settings in [hugo.yaml](hugo.yaml), not split across multiple files
- **Content dates**: Use ISO 8601 format with timezone: `2026-01-03T15:29:50+08:00`
